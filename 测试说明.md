# MCP Demo 测试说明

## 快速验证

由于 MCP Server 需要通过 Claude Desktop 进行交互，这里提供几种验证方式：

## 方法 1：使用 Claude Desktop（推荐）

### 1. 配置文件

编辑 Claude Desktop 配置：

**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`

```json
{
  "mcpServers": {
    "tools-demo": {
      "command": "node",
      "args": ["/Users/wangzhouyin/mcp-demos/1-tools-demo.js"]
    },
    "resources-demo": {
      "command": "node",
      "args": ["/Users/wangzhouyin/mcp-demos/2-resources-demo.js"]
    },
    "prompts-demo": {
      "command": "node",
      "args": ["/Users/wangzhouyin/mcp-demos/3-prompts-demo.js"]
    }
  }
}
```

### 2. 重启 Claude Desktop

完全退出并重新启动 Claude Desktop 应用。

### 3. 测试用例

#### 测试 Tools

```
💬 帮我计算 123 + 456
💬 查询北京的天气
💬 计算 100 除以 5
```

期望结果：Claude 会调用相应的工具并返回计算结果或天气信息。

---

#### 测试 Resources

```
💬 显示所有用户列表
💬 查看产品目录
💬 获取系统配置信息
💬 查询 ID 为 1 的用户信息
```

期望结果：Claude 会读取相应的资源并展示数据。

---

#### 测试 Prompts

在 Claude Desktop 的提示模板中，你应该能看到：
- ✅ code_review（代码审查）
- ✅ generate_docs（生成文档）
- ✅ bug_analysis（Bug 分析）
- ✅ api_design（API 设计）

选择任意模板，填入参数，查看 Claude 的响应。

---

## 方法 2：查看 Server 日志

### 启动单个 Server（调试模式）

```bash
# 测试 Tools Demo
node 1-tools-demo.js

# 测试 Resources Demo
node 2-resources-demo.js

# 测试 Prompts Demo
node 3-prompts-demo.js
```

如果启动成功，你会看到：
```
Tools Demo MCP Server 已启动
```

> 注意：直接运行时，Server 会等待来自 Claude 的连接，不会有其他输出。

---

## 方法 3：检查配置是否正确

### 验证 Node.js 环境

```bash
node --version  # 应该 >= 18
```

### 验证依赖安装

```bash
npm list @modelcontextprotocol/sdk
```

应该显示：
```
mcp-demos@1.0.0
└── @modelcontextprotocol/sdk@1.25.3
```

### 验证文件语法

```bash
node --check 1-tools-demo.js
node --check 2-resources-demo.js
node --check 3-prompts-demo.js
```

如果没有输出，说明语法正确。

---

## 常见问题

### Q1: Server 未连接到 Claude

**解决方案：**
1. 检查配置文件路径是否正确（绝对路径）
2. 完全退出 Claude Desktop（不是最小化）
3. 重新启动 Claude Desktop
4. 检查 Claude Desktop 的日志文件

### Q2: 工具/资源不显示

**解决方案：**
1. 确认 package.json 中有 `"type": "module"`
2. 检查 Node.js 版本 >= 18
3. 清除 Claude Desktop 缓存后重试

### Q3: 提示模板不可用

**解决方案：**
1. 确认 prompts-demo server 已在配置文件中
2. 检查参数定义是否正确
3. 重启 Claude Desktop

---

## 预期效果截图

### Tools Demo
```
👤 用户: 帮我计算 50 * 20
🤖 Claude: 正在调用计算工具...
         计算结果: 50 multiply 20 = 1000
```

### Resources Demo
```
👤 用户: 显示所有用户
🤖 Claude: 正在读取用户列表...
         当前系统有以下用户：
         1. 张三 - 开发工程师
         2. 李四 - 产品经理
         3. 王五 - 设计师
```

### Prompts Demo
```
👤 用户: [选择代码审查模板]
🤖 Claude: 根据您提供的代码，进行以下审查：
         1. 代码质量：...
         2. 性能问题：...
         3. 安全性：...
```

---

## 调试技巧

### 启用详细日志

在配置文件中添加环境变量：

```json
{
  "mcpServers": {
    "tools-demo": {
      "command": "node",
      "args": ["/Users/wangzhouyin/mcp-demos/1-tools-demo.js"],
      "env": {
        "DEBUG": "*"
      }
    }
  }
}
```

### 查看 Claude Desktop 日志

**macOS**:
```bash
tail -f ~/Library/Logs/Claude/mcp*.log
```

**Windows**:
```
%LOCALAPPDATA%\Claude\logs\
```

---

## 下一步

一旦验证成功，你可以：

1. ✅ 修改 demo 代码，添加更多工具
2. ✅ 创建自己的 Resources 数据源
3. ✅ 设计团队专用的 Prompts 模板
4. ✅ 将多个概念组合成完整应用

---

## 联系支持

遇到问题？查看：
- [MCP 官方文档](https://modelcontextprotocol.io)
- [GitHub Issues](https://github.com/modelcontextprotocol/sdk/issues)
- 公众号留言咨询
